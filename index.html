<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
  
  <title>SUST EEE Cover Page Generator | Official Tool</title>
  <meta name="description" content="Free tool for SUST EEE students to generate official assignment, lab report, and project cover pages instantly in DOCX format.">
  <meta name="robots" content="index, follow">
  
  <link rel="canonical" href="https://mubarokkamil.github.io/EEE-SUST-Cover-Page-Generator/" />

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R26N00HCVZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-R26N00HCVZ');
  </script>

  <!-- Open Graph -->
  <meta property="og:title" content="SUST EEE Cover Page Generator">
  <meta property="og:image" content="https://mubarokkamil.github.io/EEE-SUST-Cover-Page-Generator/sust-eee_logo.png">
  <meta property="og:type" content="website">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,600;1,400&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --sust-navy: #0A2647;
      --sust-blue: #003366;
      --sust-gold: #D4AF37;
      --border: #cbd5e1;
      --success: #2d6a4f;
      --error: #9B1D41;
      --ilovepdf-green: #28a745;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background-color: #f5f7fa;
      padding: 1rem;
      line-height: 1.6;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .hidden { display: none !important; }
    
    .page-container {
      max-width: 850px;
      width: 100%;
      margin: auto;
      background: white;
      border-radius: 1.25rem;
      overflow: hidden;
      box-shadow: 0 12px 35px rgba(10, 38, 71, 0.12);
    }
    
    /* === Header === */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem 2rem;
      border-bottom: 1px solid #e2e8f0;
      background-color: #fdfdfd;
    }
    .header-logo { width: 70px; height: auto; flex-shrink: 0; }
    .header-text { text-align: right; color: var(--sust-navy); }
    .header-text h1 { font-family: 'EB Garamond', Georgia, serif; font-size: 1.5rem; font-weight: 600; margin: 0; }
    .header-text p { font-size: 0.9rem; opacity: 0.9; margin: 0; }

    /* === Landing Page === */
    .landing-main { text-align: center; padding: 3rem 2rem; }
    .landing-main h2 { font-family: 'EB Garamond', serif; font-size: 2rem; color: var(--sust-navy); margin-bottom: 0.5rem; line-height: 1.2; }
    .landing-main p { font-size: 1rem; color: #4a5568; max-width: 600px; margin: 0 auto 2.5rem auto; }
    
    .selection-grid { 
      display: grid; 
      grid-template-columns: 1fr; 
      gap: 1rem; 
    }

    .selection-box { 
      cursor: pointer; 
      display: flex; 
      flex-direction: column;
      justify-content: center;
      padding: 1.5rem; 
      background-color: #f8fafc; 
      border: 2px solid var(--border); 
      border-radius: 0.75rem; 
      color: var(--sust-blue); 
      transition: all 0.3s ease; 
      text-align: left;
      min-height: 140px; 
    }
    .selection-box:hover, .selection-box:active { 
        border-color: var(--sust-gold); 
        transform: translateY(-3px); 
        box-shadow: 0 8px 25px rgba(212, 175, 55, 0.15); 
        background-color: #fff; 
    }
    .selection-box h3 { font-family: 'EB Garamond', serif; font-size: 1.25rem; margin-bottom: 0.25rem; }
    .selection-box span { font-size: 0.85rem; color: #4a5568; }

    .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 600; margin-bottom: 0.5rem; width: fit-content;}
    .badge-ind { background: #e0f2fe; color: #0369a1; }
    .badge-grp { background: #fef3c7; color: #92400e; }

    /* === Generator Page === */
    .generator-main { padding: 2.5rem 2rem; }
    .generator-main h3 { font-family: 'EB Garamond', serif; font-size: 1.75rem; color: var(--sust-navy); text-align: center; margin-bottom: 2rem; font-weight: 600; line-height: 1.2; }
    
    /* === Template Selector === */
    .template-selector-container {
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid #e2e8f0;
    }
    .template-options {
        display: flex;
        gap: 1.5rem;
        justify-content: center;
        flex-wrap: wrap;
    }
    .t-option {
        cursor: pointer;
        border: 3px solid transparent;
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.2s ease;
        width: 45%;
        max-width: 150px;
        text-align: center;
        background: #fff;
    }
    .t-option img {
        width: 100%;
        height: auto;
        display: block;
        border-radius: 6px;
        border: 1px solid #e2e8f0;
    }
    .t-option.selected {
        border-color: var(--sust-gold);
        transform: scale(1.05);
        box-shadow: 0 4px 15px rgba(212, 175, 55, 0.25);
    }
    .t-option p {
        margin: 8px 0 0;
        font-size: 0.85rem;
        font-weight: 600;
        color: var(--sust-navy);
    }

    .form-grid { display: grid; grid-template-columns: 1fr; gap: 1.25rem; }
    label { display: block; margin-bottom: 0.4rem; font-weight: 500; color: #2d3748; font-size: 0.9rem; }
    
    input { 
        width: 100%; 
        padding: 0.9rem 1rem; 
        border: 2px solid var(--border); 
        border-radius: 0.6rem; 
        font-size: 16px; 
        background: #fdfdfd; 
        transition: all 0.3s ease; 
    }
    input:focus { outline: none; border-color: var(--sust-gold); box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.1); background: white; }
    
    .group-members-container {
        grid-column: 1 / -1;
        background: #fffbeb;
        border: 1px solid #fcd34d;
        padding: 1.25rem;
        border-radius: 0.75rem;
    }
    .member-input-row { margin-bottom: 0.75rem; }
    
    .field-group { padding: 1.25rem; background: #f9fbfc; border-radius: 0.875rem; border: 1.5px dashed var(--border); margin-top: 1.5rem; opacity: 0; max-height: 0; overflow: hidden; transition: all 0.4s ease-in-out; visibility: hidden; }
    .field-group.visible { opacity: 1; max-height: 1000px; border-style: solid; border-color: var(--sust-gold); background: #fefef9; visibility: visible; }
    
    button { width: 100%; background: var(--sust-blue); color: white; padding: 1.1rem; border: none; border-radius: 0.75rem; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 2rem; }
    button:hover:not(:disabled) { background: #002b55; transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0, 51, 102, 0.25); }
    
    #status { margin-top: 1rem; text-align: center; font-weight: 500; padding: 1rem; border-radius: 0.5rem; word-wrap: break-word;}

    .converter-container {
        margin-top: 2rem; background-color: #f1f5f9; border: 1px solid #cbd5e1;
        border-radius: 0.75rem; padding: 1.25rem; text-align: center;
        display: flex; flex-direction: column; align-items: center; gap: 0.75rem;
    }
    .converter-btn { background-color: var(--ilovepdf-green); color: white; text-decoration: none; padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 600; transition: background-color 0.2s; font-size: 0.95rem; display: inline-block;}
    .converter-btn:hover { background-color: #218838; }
    
    .page-footer { text-align: center; padding: 2rem 1rem; color: #64748b; font-size: 0.8rem; }
    #backButton { cursor: pointer; display: inline-block; margin-top: 1.5rem; color: var(--sust-blue); text-decoration: underline; padding: 10px;}

    @media (max-width: 600px) {
        body { padding: 0.5rem; }
        .page-container { width: 100%; border-radius: 0.75rem; }
        .header { flex-direction: column; text-align: center; padding: 1.25rem 1rem; gap: 0.75rem; }
        .header-text { text-align: center; }
        .header-logo { width: 60px; }
        .header-text h1 { font-size: 1.35rem; }
        .landing-main { padding: 2rem 1.25rem; }
        .generator-main { padding: 2rem 1.25rem; }
        .selection-box { padding: 1.25rem; min-height: auto; }
        #status { font-size: 0.9rem; }
        .t-option { width: 48%; } 
    }

    @media (min-width: 640px) {
      .selection-grid { grid-template-columns: 1fr 1fr; }
      .form-grid { grid-template-columns: 1fr 1fr; }
      .selection-box[data-choice="project"] { grid-column: span 2; }
    }
    @media (min-width: 768px) {
        .selection-grid { grid-template-columns: repeat(3, 1fr); }
        .selection-box[data-choice="project"] { grid-column: span 1; }
        .header-logo { width: 70px; }
        .generator-main { padding: 3.5rem 4.5rem; }
    }
  </style>
</head>
<body>

  <!-- Landing Page -->
  <div id="landingPage" class="page-container">
    <header class="header">
      <img src="sust-eee_logo.png" alt="SUST EEE Logo" class="header-logo">
      <div class="header-text">
        <h1>SUST EEE Cover Page Generator</h1>
        <p>Dept. of Electrical & Electronic Engineering</p>
      </div>
    </header>
    <main class="landing-main">
      <h2>Select Document Type</h2>
      <p>Choose the specific template for your submission.</p>
            
      <div class="selection-grid">
        <!-- Individual Lab -->
        <div class="selection-box" data-choice="lab" data-type="individual">
          <div class="badge badge-ind">Individual</div>
          <h3>Lab Report</h3>
          <span>For individual experiments.</span>
        </div>
        
        <!-- Group Lab -->
        <div class="selection-box" data-choice="group-lab" data-type="group">
          <div class="badge badge-grp">Group</div>
          <h3>Group Lab Report</h3>
          <span>For group experiments (Multiple Reg No).</span>
        </div>

        <!-- Individual Assignment -->
        <div class="selection-box" data-choice="assignment" data-type="individual">
          <div class="badge badge-ind">Individual</div>
          <h3>Assignment</h3>
          <span>Theoretical courses (Individual).</span>
        </div>

        <!-- Group Assignment -->
        <div class="selection-box" data-choice="group-assignment" data-type="group">
          <div class="badge badge-grp">Group</div>
          <h3>Group Assignment</h3>
          <span>Theoretical courses (Groupwise).</span>
        </div>

        <!-- Project Report -->
        <div class="selection-box" data-choice="project" data-type="group">
          <div class="badge badge-grp">Group/Individual</div>
          <h3>Project Report</h3>
          <span>For semester projects.</span>
        </div>
      </div>
    </main>
  </div>

  <!-- Generator Page -->
  <div id="generatorPage" class="page-container hidden">
    <header class="header">
      <img src="sust-eee_logo.png" alt="SUST EEE Logo" class="header-logo">
      <div class="header-text">
        <h1>SUST EEE Cover Page Generator</h1>
        <p>Dept. of Electrical & Electronic Engineering</p>
      </div>
    </header>
    <main class="generator-main">
      <h3 id="formTitle">Enter Details</h3>

      <!-- === Lab Template Selector (Visible for Individual Lab) === -->
      <div id="labTemplateSelector" class="template-selector-container hidden">
          <h4 style="text-align:center; margin-bottom:1rem; color:var(--sust-navy); font-size:1.1rem;">Choose Cover Style</h4>
          <div class="template-options">
              <!-- Option 1 -->
              <div class="t-option selected" onclick="selectTemplate('lab-template.docx', this)">
                  <img src="lab-template.jpg" alt="Style 1">
                  <p>Style 1</p>
              </div>
              <!-- Option 2 -->
              <div class="t-option" onclick="selectTemplate('lab-template-2.docx', this)">
                  <img src="lab-template-2.jpg" alt="Style 2">
                  <p>Style 2</p>
              </div>
          </div>
      </div>

      <!-- === Assignment Template Selector (Visible for Individual Assignment) === -->
      <div id="assignTemplateSelector" class="template-selector-container hidden">
          <h4 style="text-align:center; margin-bottom:1rem; color:var(--sust-navy); font-size:1.1rem;">Choose Cover Style</h4>
          <div class="template-options">
              <!-- Option 1 -->
              <div class="t-option selected" onclick="selectTemplate('Assignment-template.docx', this)">
                  <img src="Assignment-template.jpg" alt="Style 1">
                  <p>Style 1</p>
              </div>
              <!-- Option 2 -->
              <div class="t-option" onclick="selectTemplate('Assignment-template-2.docx', this)">
                  <img src="Assignment-template-2.jpg" alt="Style 2">
                  <p>Style 2</p>
              </div>
          </div>
      </div>

      <form id="dataForm">
        <input type="hidden" id="templateDocxFile" value="">
        <input type="hidden" id="Dept_Name" value="Electrical and Electronic Engineering">

        <div class="form-grid">
          <div><label for="Course_Code">Course Code</label><input type="text" id="Course_Code" required placeholder="e.g. EEE 322"></div>
          <div><label for="Course_Title">Course Title</label><input type="text" id="Course_Title" required placeholder="e.g. Digital Signal Processing"></div>
          
          <!-- Teacher Inputs -->
          <div>
            <label for="Course_Teacher">Course Teacher</label>
            <input type="text" id="Course_Teacher" list="teacher-list" required placeholder="Select or type name">
            <datalist id="teacher-list">
                <option value="Dr. Ifte Khairul Amin">
                <option value="Dr. Md Rasedujjaman">
                <option value="Dr. Mohammad Kamruzzaman Khan Prince">
                <option value="Arif Ahammad">
                <option value="Md. Shariful Islam">
                <option value="Mohona Das Gupta">
                <option value="Naima Sultana Alam Supti">
                <option value="Md. Kabir Hasan">
                <option value="AFSHANA BEGUM">
                <option value="Md. Tasfiq Rahman">
                <option value="Myen Uddin">
            </datalist>
          </div>

          <div>
            <label for="Course_Teacher_Details">Teacher Designation</label>
            <input type="text" id="Course_Teacher_Details" list="designation-list" required placeholder="Select or type designation">
            <datalist id="designation-list">
                <option value="Professor, Dept. of EEE, SUST">
                <option value="Associate Professor, Dept. of EEE, SUST">
                <option value="Assistant Professor, Dept. of EEE, SUST">
                <option value="Lecturer, Dept. of EEE, SUST">
            </datalist>
          </div>

          <!-- === INDIVIDUAL SECTION === -->
          <div id="singleStudentSection" style="display:contents;">
            <div><label for="Reg_No">Registration No.</label><input type="text" id="Reg_No" placeholder="e.g. 2020331024"></div>
            <div><label for="Name">Student Name</label><input type="text" id="Name" placeholder="e.g. Mohammad"></div>
          </div>

          <!-- === GROUP / PROJECT MEMBER SECTION === -->
          <div id="groupSection" class="group-members-container hidden">
             <label for="memberCount">How many members are in your group?</label>
             <input type="number" id="memberCount" min="1" max="10" placeholder="Enter number (e.g. 4)" style="margin-bottom: 1rem;">
             <div id="dynamicMemberInputs"></div>
          </div>
          
          <div>
              <label for="Submission_Date">Date of Submission</label>
              <input type="date" id="Submission_Date" required>
          </div>
        </div>

        <!-- === DYNAMIC FIELDS === -->
        
        <!-- Lab Fields: Has Group No (Standard) -->
        <div id="labFields" class="field-group">
          <div class="form-grid">
            <div><label for="Exp_No">Experiment No.</label><input type="text" id="Exp_No" placeholder="e.g. 01"></div>
            <div><label for="Group_No">Group No</label><input type="text" id="Group_No" placeholder="e.g. Group A"></div>
            <div style="grid-column: 1 / -1;"><label for="Exp_Name">Experiment Name</label><input type="text" id="Exp_Name" placeholder="e.g. Study of RC Circuit"></div>
          </div>
        </div>

        <!-- Assignment Fields: Added Group No for Group Assignments -->
        <div id="assignmentFields" class="field-group">
            <div class="form-grid">
                 <!-- Group No for Assignment (Visible only for group-assignment via JS logic) -->
                 <div id="assignGroupNoContainer" class="hidden">
                    <label for="Group_No_Assign">Group No</label>
                    <input type="text" id="Group_No_Assign" placeholder="e.g. Group 5">
                 </div>
                <div style="grid-column: 1 / -1;">
                    <label for="Assignment_Name">Assignment Title</label>
                    <input type="text" id="Assignment_Name" placeholder="e.g. Assignment on Fourier Transform">
                </div>
            </div>
        </div>

        <!-- Project Fields: Added Group No for Projects -->
        <div id="projectFields" class="field-group">
            <div class="form-grid">
                <!-- Group No for Project -->
                 <div>
                    <label for="Group_No_Project">Group No</label>
                    <input type="text" id="Group_No_Project" placeholder="e.g. Group 3">
                 </div>
                <div style="grid-column: 1 / -1;">
                    <label for="Project_Name">Project Title</label>
                    <input type="text" id="Project_Name" placeholder="e.g. Design and Implementation of a Smart Grid">
                </div>
            </div>
        </div>
        
        <button type="submit" id="generateDocxButton">Download Cover Page (.docx)</button>
      </form>
      
      <div id="status"></div>

      <div class="converter-container">
        <p style="margin:0; font-weight:500; color:#334155;">Need PDF format?</p>
        <a href="https://www.ilovepdf.com/word_to_pdf" target="_blank" rel="noopener noreferrer" class="converter-btn">Convert DOCX to PDF (Online)</a>
      </div>
      
      <p style="text-align:center;"><a id="backButton">← Back to selection</a></p>
    </main>
  </div>
  
 <footer class="page-footer">
    <p>Developed by <strong>Mubarok Hossen Kamil</strong> • EEE, SUST • Batch 2022</p>
</footer>

  <!-- Libraries -->
  <script src="https://unpkg.com/pizzip@3.1.7/dist/pizzip.js"></script>
  <script src="https://unpkg.com/docxtemplater@3.30.1/build/docxtemplater.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <script>
    // Global function for clicking templates
    function selectTemplate(filename, element) {
        document.getElementById('templateDocxFile').value = filename;
        
        // Update Visual Selection
        let siblings = element.parentElement.children;
        for (let i = 0; i < siblings.length; i++) {
            siblings[i].classList.remove('selected');
        }
        element.classList.add('selected');
    }

    document.addEventListener('DOMContentLoaded', () => {
      const landingPage = document.getElementById('landingPage');
      const generatorPage = document.getElementById('generatorPage');
      const choiceButtons = document.querySelectorAll('.selection-box');
      const backButton = document.getElementById('backButton');
      
      const form = document.getElementById('dataForm');
      const hiddenTemplateDocxInput = document.getElementById('templateDocxFile');
      const formTitle = document.getElementById('formTitle');
      
      const labFields = document.getElementById('labFields');
      const assignmentFields = document.getElementById('assignmentFields');
      const projectFields = document.getElementById('projectFields');
      const assignGroupNoContainer = document.getElementById('assignGroupNoContainer');
      
      const singleStudentSection = document.getElementById('singleStudentSection');
      const groupSection = document.getElementById('groupSection');
      const memberCountInput = document.getElementById('memberCount');
      const dynamicMemberInputs = document.getElementById('dynamicMemberInputs');
      const status = document.getElementById('status');
      const generateDocxButton = document.getElementById('generateDocxButton');

      // Selectors
      const labTemplateSelector = document.getElementById('labTemplateSelector');
      const assignTemplateSelector = document.getElementById('assignTemplateSelector');

      // --- Member Inputs ---
      memberCountInput.addEventListener('input', (e) => {
          const count = parseInt(e.target.value);
          dynamicMemberInputs.innerHTML = ''; 
          if(count && count > 0) {
              for(let i = 1; i <= count; i++) {
                  const div = document.createElement('div');
                  div.className = 'member-input-row';
                  div.innerHTML = `
                    <label style="font-size:0.85rem; color:#666;">Member ${i} Reg. No.</label>
                    <input type="text" class="group-reg-input" placeholder="e.g. 20203310XX" required>
                  `;
                  dynamicMemberInputs.appendChild(div);
              }
          }
      });

      // --- View Logic ---
      const showGenerator = (choice, type) => {
        form.reset();
        status.innerHTML = '';
        status.style.backgroundColor = '';
        dynamicMemberInputs.innerHTML = '';
        
        // Reset Template Selectors
        labTemplateSelector.classList.add('hidden');
        assignTemplateSelector.classList.add('hidden');
        document.querySelectorAll('.t-option').forEach(el => el.classList.remove('selected'));
        
        // Reset Fields
        labFields.classList.remove('visible');
        assignmentFields.classList.remove('visible');
        projectFields.classList.remove('visible');
        assignGroupNoContainer.classList.add('hidden'); // Default hide Group No for assignments
        
        // Toggle Group/Individual Section
        if(type === 'group') {
            singleStudentSection.style.display = 'none';
            document.getElementById('Reg_No').required = false;
            document.getElementById('Name').required = false;
            groupSection.classList.remove('hidden');
            memberCountInput.required = true;
        } else {
            singleStudentSection.style.display = 'contents';
            document.getElementById('Reg_No').required = true;
            document.getElementById('Name').required = true;
            groupSection.classList.add('hidden');
            memberCountInput.required = false;
        }

        switch(choice) {
            case 'lab':
                // Show Selector, Default to Template 1
                labTemplateSelector.classList.remove('hidden');
                if(labTemplateSelector.querySelector('.t-option')) labTemplateSelector.querySelector('.t-option').classList.add('selected');
                hiddenTemplateDocxInput.value = 'lab-template.docx';
                
                labFields.classList.add('visible');
                formTitle.textContent = "Individual Lab Report Details";
                break;

            case 'group-lab':
                hiddenTemplateDocxInput.value = 'Grouped-Lab-template.docx';
                labFields.classList.add('visible');
                formTitle.textContent = "Group Lab Report Details";
                break;

            case 'assignment':
                // Show Selector, Default to Template 1
                assignTemplateSelector.classList.remove('hidden');
                if(assignTemplateSelector.querySelector('.t-option')) assignTemplateSelector.querySelector('.t-option').classList.add('selected');
                hiddenTemplateDocxInput.value = 'Assignment-template.docx';
                
                assignmentFields.classList.add('visible');
                formTitle.textContent = "Individual Assignment Details";
                break;

            case 'group-assignment':
                hiddenTemplateDocxInput.value = 'Grouped-Assignment-template.docx';
                assignmentFields.classList.add('visible');
                assignGroupNoContainer.classList.remove('hidden'); // Show Group No
                formTitle.textContent = "Group Assignment Details";
                break;

            case 'project':
                hiddenTemplateDocxInput.value = 'Project-report-template.docx';
                projectFields.classList.add('visible'); 
                formTitle.textContent = "Project Report Details";
                break;
        }

        landingPage.classList.add('hidden');
        generatorPage.classList.remove('hidden');
        window.scrollTo(0, 0);
        
        if (typeof gtag === 'function') {
            gtag('event', 'select_template', { 'template_type': choice });
        }
      };

      const showLanding = () => {
        generatorPage.classList.add('hidden');
        landingPage.classList.remove('hidden');
        window.scrollTo(0, 0);
      };

      choiceButtons.forEach(button => {
        button.addEventListener('click', () => {
          const choice = button.getAttribute('data-choice');
          const type = button.getAttribute('data-type');
          showGenerator(choice, type);
        });
      });

      backButton.addEventListener('click', showLanding);

      // --- Date Formatter ---
      const formatDateString = (dateStr) => {
        if (!dateStr) return "";
        const parts = dateStr.split("-");
        const year = parts[0];
        const monthIndex = parseInt(parts[1], 10) - 1;
        const day = parseInt(parts[2], 10);
        const months = ["January", "February", "March", "April", "May", "June","July", "August", "September", "October", "November", "December"];
        const getOrdinal = (n) => {
            if (n > 3 && n < 21) return 'th';
            switch (n % 10) { case 1: return "st"; case 2: return "nd"; case 3: return "rd"; default: return "th"; }
        };
        return `${day}${getOrdinal(day)} ${months[monthIndex]}, ${year}`;
      };

      // --- Data Collection ---
      const getFormData = () => {
        const rawDate = document.getElementById('Submission_Date').value;
        const isGroup = !groupSection.classList.contains('hidden');
        
        // Smart Group No Collection: Checks all 3 possible fields
        let groupNo = "";
        const g1 = document.getElementById('Group_No').value.trim(); // Lab
        const g2 = document.getElementById('Group_No_Assign').value.trim(); // Assign
        const g3 = document.getElementById('Group_No_Project').value.trim(); // Project
        
        // Logic: Grab whichever is visible/populated. 
        if (g1) groupNo = g1;
        else if (g2) groupNo = g2;
        else if (g3) groupNo = g3;

        let finalData = {
          Dept_Name: document.getElementById('Dept_Name').value,
          Course_Code: document.getElementById('Course_Code').value.trim(),
          Course_Title: document.getElementById('Course_Title').value.trim(),
          Course_Teacher: document.getElementById('Course_Teacher').value.trim(),
          Course_Teacher_Details: document.getElementById('Course_Teacher_Details').value.trim(),
          Submission_Date: formatDateString(rawDate),
          Exp_No: document.getElementById('Exp_No')?.value.trim() || '',
          
          // Unified Group No
          Group_No: groupNo,

          Exp_Name: document.getElementById('Exp_Name')?.value.trim() || '',
          Assignment_Name: document.getElementById('Assignment_Name')?.value.trim() || '',
          Project_Name: document.getElementById('Project_Name')?.value.trim() || ''
        };

        if (isGroup) {
            const regInputs = document.querySelectorAll('.group-reg-input');
            let groupMembersString = "";
            regInputs.forEach(input => {
                if(input.value.trim() !== "") {
                    groupMembersString += `Reg. No.: ${input.value.trim()}\n`;
                }
            });
            finalData.Group_Members = groupMembersString.replace(/\n$/, "");
            finalData.Reg_No = ""; 
            finalData.Name = "";
        } else {
            finalData.Reg_No = document.getElementById('Reg_No').value.trim();
            finalData.Name = document.getElementById('Name').value.trim();
            finalData.Group_Members = "";
        }
        
        return finalData;
      };

      const updateStatus = (message, type) => {
        status.innerHTML = message;
        if(type === 'success') {
            status.style.color = 'var(--success)';
            status.style.backgroundColor = 'rgba(45, 106, 79, 0.1)';
        } else if (type === 'error') {
            status.style.color = 'var(--error)';
            status.style.backgroundColor = 'rgba(155, 29, 65, 0.1)';
        } else {
            status.style.color = 'var(--sust-blue)';
            status.style.backgroundColor = '';
        }
      };

      // --- Document Generation ---
      generateDocxButton.addEventListener('click', async (e) => {
        e.preventDefault(); 
        status.innerHTML = '<em>Reading template...</em>';
        status.style.backgroundColor = '';
        
        const templateFile = hiddenTemplateDocxInput.value;
        if (!templateFile) {
            updateStatus('Error: Template not defined.', 'error');
            return;
        }

        const data = getFormData();
        if (!form.checkValidity()) {
          form.reportValidity();
          updateStatus('Please fill in all required fields.', 'error');
          return;
        }

        try {
          const response = await fetch(templateFile);
          if (!response.ok) throw new Error(`Template file '${templateFile}' not found.`);
          
          const content = await response.arrayBuffer();
          const zip = new PizZip(content);
          
          const doc = new docxtemplater(zip, { paragraphLoop: true, linebreaks: true });
          doc.render(data);

          const blob = doc.getZip().generate({ type: 'blob', mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
          
          let fileName = "Cover_Page.docx";
          if(data.Reg_No) {
             fileName = `${data.Course_Code}_${data.Reg_No}.docx`;
          } else {
             fileName = `${data.Course_Code}_Group_Cover.docx`;
          }

          saveAs(blob, fileName.replace(/[^a-zA-Z0-9_-]/g, '_'));
          updateStatus('Cover page downloaded successfully!', 'success');

          if (typeof gtag === 'function') {
              gtag('event', 'generate_document', {
                  'event_category': 'Engagement',
                  'event_label': templateFile,
                  'course_code': data.Course_Code
              });
          }

        } catch (error) {
          console.error(error);
          if (error.properties && error.properties.errors instanceof Array) {
            const errorMessages = error.properties.errors.map(function (e) {
              return e.properties.explanation;
            }).join("<br>");
            updateStatus('<strong>Template Error:</strong><br>' + errorMessages, 'error');
          } else {
            updateStatus('Error: ' + error.message, 'error');
          }
        }
      });

    });
  </script>
</body>
</html>